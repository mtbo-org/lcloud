plugins {
    id 'java-library'
    id 'maven-publish'
    id('com.diffplug.spotless') version "7.0.3"
    id 'java'
}


def javaProjects = [
        project(":lcloud-udp-discovery"),
        project(":lcloud-udp-discovery-example"),
]



configure(javaProjects) {

    version '3.0.0'
    repositories {
        mavenCentral()
        if (project.version.endsWith('-SNAPSHOT')) {
            maven { url 'https://oss.sonatype.org/content/repositories/snapshots/' }
            configurations.all { resolutionStrategy.cacheChangingModulesFor 0, 'seconds' }
        }
    }

    apply plugin: 'java-library'

    dependencies {
        implementation "io.projectreactor:reactor-core:3.8.0-M3"
        testImplementation "io.projectreactor:reactor-test:3.8.0-M3"
    }

    apply plugin: 'com.diffplug.spotless'

    spotless {
        java {
            // Use the default importOrder configuration
            importOrder()

            removeUnusedImports()

            // Cleanthat will refactor your code, but it may break your style: apply it before your formatter
            cleanthat()          // has its own section below

            // Choose one of these formatters.
            googleJavaFormat()   // has its own section below

            formatAnnotations()  // fixes formatting of type annotations, see below

            licenseHeaderFile project.rootDir.toString() + '/license.header.java'
        }
    }

    test {
        useJUnitPlatform()
    }
}

